version: "3.2"
services:
  localnode:
    image: oasisdexorg/localnode:3e0eb9506f9ba1db60263fe5592d0e42021270c4
    command: master
    ports:
      - "8545:8545"

  postgres:
    image: postgres:10.6
    container_name: postgres-vulcan2x
    environment:
      - POSTGRES_USER=user
      - POSTGRES_PASSWORD=password
      - POSTGRES_HOST=localhost
      - POSTGRES_PORT=5432
      - POSTGRES_DB=database
    ports:
      - "5432:5432"

  oasis-cache-etl:
    image: oasisdexorg/oasis-cache:3e17430b867beda9f89570f2bc35d65bdfd711b5
    environment:
      VL_DB_DATABASE: database
      VL_DB_USER: user
      VL_DB_PASSWORD: password
      VL_DB_HOST: postgres
      VL_DB_PORT: 5432
      VL_CHAIN_NAME: localnet
      VL_CHAIN_HOST: http://localnode:8545
    entrypoint: sh -c
    command:
      - sleep 10 && yarn migrate && yarn start-etl

  oasis-cache-api:
    image: oasisdexorg/oasis-cache:3e17430b867beda9f89570f2bc35d65bdfd711b5
    environment:
      VL_DB_DATABASE: database
      VL_DB_USER: user
      VL_DB_PASSWORD: password
      VL_DB_HOST: postgres
      VL_DB_PORT: 5432
      VL_CHAIN_NAME: localnet
      VL_CHAIN_HOST: http://localnode:8545
    ports:
      - "3001:3001"
    entrypoint: sh -c
    command:
      - sleep 15 && yarn start-api
